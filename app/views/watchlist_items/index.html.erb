<h1>üçø My Watchlist</h1>

<% if @rows.blank? %>
  <p>Your watchlist is empty.üò¢ <a href = "/"> Time to explore movies!</p>
<% else %>
    <p>You have <%= @rows.size %> movie<%= "s" if @rows.size != 1 %> saved.</p>

  <table role="grid" class="results-table">
    <thead>
      <tr>
        <th>Movie</th>
        <th>‚≠ê Rating</th>
        <th>Added on</th>
        <th>Actions</th>
      </tr>
    </thead>

    <tbody>
      <% @rows.each do |row| %>
         <% item  = row[:item] %>
        <% movie = row[:movie] %>
        <tr>
          <td>
            <a href="/movies/<%= movie["id"] %>">
              <strong><%= movie["title"] %></strong>
            </a>
          </td>

          <td>‚≠ê <%= (movie["vote_average"] || 0).round(1) %></td>

          <td>
            <%= item.created_at.in_time_zone("America/Chicago").strftime("%b %-d, %Y") %>
          </td>

          <td>
            <!-- Mark seen directly from watchlist -->
            <form action="/mark_seen" method="post" style="display:inline;">
              <input type="hidden" name="authenticity_token" value="<%= form_authenticity_token %>">
              <input type="hidden" name="tmdb_id" value="<%= movie["id"] %>">
              <button style="font-size: 0.8rem; padding: 0.1rem 0.4rem;">
              üëÄ Seen
              </button>
            </form>

            <!-- Remove button (small text) -->
            <form action="/remove_from_watchlist" method="post">
              <input type="hidden" name="authenticity_token" value="<%= form_authenticity_token %>">
              <input type="hidden" name="tmdb_id" value="<%= movie["id"] %>">
              <button style="font-size: 0.8rem; padding: 0.1rem 0.4rem;">
                ‚ùå Remove
              </button>
            </form>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
<% end %>
